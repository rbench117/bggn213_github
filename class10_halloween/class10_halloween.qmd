---
title: "class10 halloween mini project"
author: Ryan Bench (PID:A69038034)
format: pdf
---

```{r}

candy_file <- "https://raw.githubusercontent.com/fivethirtyeight/data/master/candy-power-ranking/candy-data.csv"

candy = read.csv(candy_file, row.names=1)
head(candy)
```

```{r}
dim(candy)
nrow(candy)
sum(candy)
```


>Q1. How many different candy types are in this dataset?

There are 12 candy types in this dataset, with 85 different individual candies.

```{r}
sum(candy$fruity)
```

>Q2. How many fruity candy types are in the dataset?

There are 38 fruity candy types in the dataset.

```{r}
candy["Twix", ]$winpercent
```

```{r}
candy["Milky Way", ]$winpercent
```


>Q3. What is your favorite candy in the dataset and what is it’s winpercent value?

My favorite candy in the dataset is a Milky Way bar, and the winpercent value is 73.09956.

```{r}
candy["Kit Kat", ]$winpercent
```


>Q4. What is the winpercent value for “Kit Kat”?

The winpercent value is 76.7686.

```{r}
candy["Tootsie Roll Snack Bars", ]$winpercent
```


>Q5. What is the winpercent value for “Tootsie Roll Snack Bars”?

The winpercent value for Tootsie Roll Snack Bars is 49.6535.

```{r}
#skimr would not render
```

>Q6. Is there any variable/column that looks to be on a different scale to the majority of the other columns in the dataset?

Winpercent scale is on 0-100 scale, the rest are on 0-1.

>Q7. What do you think a zero and one represent for the candy$chocolate column?

I believe 0 means the candy is not chocolate, but a 1 means it is chocolate.


```{r,message=FALSE}
library(dplyr)

candy|> nrow()

round( mean(candy$winpercent), 4)
```

```{r}
candy |> select(winpercent)  
```

```{r}
win <- candy$winpercent
win.mean <- mean(win)
round(win.mean)
```

```{r}
candy %>% select(winpercent)
candy |> select(winpercent)
#These are the same
```
>Q8. Plot a histogram of winpercent values

```{r}
library(ggplot2)
ggplot(candy) + aes(winpercent) + geom_histogram(bins = 20)
```
    
    
>Q9. Is the distribution of winpercent values symmetrical?

```{r}
ggplot(candy) + aes(winpercent) + geom_density()
```


>Q10. Is the center of the distribution above or below 50%?
    
The center is below 50% according to the plots. According to the mean it is 50%.
```{r}
mean(candy$winpercent)
```
  
```{r}
summary(candy$winpercent)
```

>Q11. On average is chocolate candy higher or lower ranked than fruit candy?

```{r}
#1. Find all chocolate candy in the dataset
choc.inds <- as.logical(candy$chocolate)
choc.candy <- candy[choc.inds,]
choc.candy
#2. Extract the `winpercent` values
choc.win <- choc.candy$winpercent
#3. Find the mean of these values
choc.mean <- mean(choc.win)
choc.mean
#4-6. Do the same for fruity candy
fruity.inds <- as.logical(candy$fruity)
fruity.candy <- candy[fruity.inds, ]
fruity.candy
fruity.win <- fruity.candy$winpercent
#7. Which mean value is higher
fruity.mean <- mean(fruity.win)
fruity.mean
```
Chocolate is ranked higher than fruity.

>Q12. Is this difference statistically significant?

```{r}
t.test(choc.win, fruity.win)
```

There is a statistically significant difference.

> Q13. What are the five least liked candy types in this set?

```{r}
library(dplyr)
ord.ind <- order(candy$winpercent)
head(candy[ord.ind,], 5)

```


>Q14. What are the top 5 all time favorite candy types out of this set?

```{r}
tail(candy[ord.ind,], 5)

```

>Q15. Make a first barplot of candy ranking based on winpercent values.

```{r}
candy.win <- candy %>% arrange(winpercent)
ggplot(candy.win) + 
  aes(winpercent, rownames(candy)) +
  geom_col()
```

>Q16. This is quite ugly, use the reorder() function to get the bars sorted by winpercent?

```{r}
candy.win <- candy %>% arrange(winpercent)
ggplot(candy.win) + 
  aes(winpercent, reorder(rownames(candy), winpercent)) +
  geom_col()
```


```{r}
my_cols <- rep("black", nrow(candy))
my_cols[candy$chocolate==1] <- "chocolate"
my_cols[candy$bar==1] <- "brown"
my_cols[candy$fruity==1] <- "red"
my_cols

ggplot(candy.win) + 
  aes(x=winpercent, y=reorder(rownames(candy), winpercent)) +
  geom_col(fill=my_cols)
```

>Q17. What is the worst ranked chocolate candy?

Sixlets are the worst ranked chocolate candy

>Q18. What is the best ranked fruity candy?

The best ranked fruity candy is starburst.

##Winpercent vs Pricepercent

```{r}
library(ggrepel)
ggplot(candy) +
  aes(winpercent, pricepercent, label = rownames(candy)) + 
  geom_point(col = my_cols)+
  geom_text_repel(col = my_cols)
  
```


>Q19. Which candy type is the highest ranked in terms of winpercent for the least money - i.e. offers the most bang for your buck?
  
Reese's miniatures 

>Q20. What are the top 5 most expensive candy types in the dataset and of these which is the least popular?

```{r}
ord.ind.price <- order(candy$pricepercent)
tail(candy[ord.ind.price,], 5)
```


##Correlation 

```{r}
cij <- cor(candy)
```

```{r}
library(corrplot)
corrplot(cij)
```

>Q22. Examining this plot what two variables are anti-correlated (i.e. have minus values)?
    
Fruity and chocolate have strong negative values.

>Q23. Similarly, what two variables are most positively correlated?

Bar and chocolate appear to have a positive correlation.

##Principal Component Analysis

The main function in base R for this is `prcomp()` and we want to set `scale = TRUE` here:

```{r}
pca <- prcomp(candy, scale=TRUE)
summary(pca)
```

Let's look at our first main result figure - the "PC plot" or PC1 vs PC2

```{r}
ggplot(pca$x) +
  aes(PC1, PC2, label = rownames(pca$x)) +
  geom_point(col = my_cols)+
  geom_text_repel(col=my_cols) + 
  labs(title = "Ryan's candy analysis")
```

Don't forget about your variable "loadings" - how the original variables contribute to your new PCs...

```{r}
ggplot(pca$rotation) + 
  aes(PC1, rownames(pca$rotation)) +
  geom_col()

```

>Q24. What original variables are picked up strongly by PC1 in the positive direction? Do these make sense to you?

Pluribus, hard, and fruity are strongly picked up by PC1 in the positive direction. Fruity being detected makes sense to me because it appeared to be a popular choice beforehand, but hard and pluribus was a bit surprising.



